<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Docker on 随记</title><link>/tags/docker/</link><description>Recent content in Docker on 随记</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Mon, 30 Dec 2019 22:00:00 +0800</lastBuildDate><atom:link href="/tags/docker/index.xml" rel="self" type="application/rss+xml"/><item><title>给阿里云容器镜像服务器架设反向代理</title><link>/posts/docker-registry-reverse-proxy/</link><pubDate>Mon, 30 Dec 2019 22:00:00 +0800</pubDate><guid>/posts/docker-registry-reverse-proxy/</guid><description>&lt;p&gt;早期我司使用 &lt;a href="https://github.com/goharbor/harbor"&gt;Harbor&lt;/a&gt; 自建 Docker Registry，后来阿里云推出了容器镜像服务，服务还处于公测阶段，使用免费，看起来不错，但是两者的 URI 是不一样的：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;我司：registry.example.com/NAMESPACE/REPOSITORY&lt;/li&gt;
&lt;li&gt;阿里云：registry.cn-shenzhen.aliyuncs.com/PREFIX_NAMESPACE/REPOSITORY&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;除了域名不一样，两者的 namespace 也不一样，阿里云比较矬，它的 RDS、Redis 服务提供的域名是每个用户不一样的，而 docker registry 却选择了一个固定域名，于是不同租户的 namespace 名字会冲突，非常不幸的是我司用的 namespace 名字已经被人占用了，阿里云推荐的解决办法是加一个公司名字前缀。 由于这个原因，我们不能把 registry.example.com以 DNS CNAME 的方式直接映射到 registry.cn-shenzhen.aliyuncs.com，而是要借助一层 Nginx 代理：&lt;/p&gt;</description></item></channel></rss>