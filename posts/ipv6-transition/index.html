<!doctype html><html lang=en><head><meta charset=utf-8><title>IPv6 过渡机制</title><meta name=description content="IPv6 过渡机制"><meta name=author content="Yubao Liu"><meta name=viewport content="width=device-width,initial-scale=1"><noscript><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel=stylesheet type=text/css><link rel=stylesheet href=/css/fonts.css></noscript><style type=text/css media=screen>/*!Pure v3.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE*//*!normalize.css v | MIT License | https://necolas.github.io/normalize.css/
Copyright (c) Nicolas Gallagher and Jonathan Neal*//*!normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}html{font-family:sans-serif}.hidden,[hidden]{display:none !important}.pure-img{max-width:100%;height:auto;display:block}</style><style type=text/css media=screen>/*!Pure v3.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE*/.pure-menu{box-sizing:border-box}.pure-menu-fixed{position:fixed;left:0;top:0;z-index:3}.pure-menu-item,.pure-menu-list{position:relative}.pure-menu-list{list-style:none;margin:0;padding:0}.pure-menu-item{padding:0;margin:0;height:100%}.pure-menu-heading,.pure-menu-link{display:block;text-decoration:none;white-space:nowrap}.pure-menu-horizontal{width:100%;white-space:nowrap}.pure-menu-horizontal .pure-menu-list{display:inline-block}.pure-menu-horizontal .pure-menu-heading,.pure-menu-horizontal .pure-menu-item,.pure-menu-horizontal .pure-menu-separator{display:inline-block;vertical-align:middle}.pure-menu-item .pure-menu-item{display:block}.pure-menu-children{display:none;position:absolute;left:100%;top:0;margin:0;padding:0;z-index:3}.pure-menu-horizontal .pure-menu-children{left:0;top:auto;width:inherit}.pure-menu-active>.pure-menu-children,.pure-menu-allow-hover:hover>.pure-menu-children{display:block;position:absolute}.pure-menu-has-children>.pure-menu-link:after{padding-left:.5em;content:"\25B8";font-size:small}.pure-menu-horizontal .pure-menu-has-children>.pure-menu-link:after{content:"\25BE"}.pure-menu-scrollable{overflow-y:scroll;overflow-x:hidden}.pure-menu-scrollable .pure-menu-list{display:block}.pure-menu-horizontal.pure-menu-scrollable .pure-menu-list{display:inline-block}.pure-menu-horizontal.pure-menu-scrollable{white-space:nowrap;overflow-y:hidden;overflow-x:auto;padding:.5em 0}.pure-menu-horizontal .pure-menu-children .pure-menu-separator,.pure-menu-separator{background-color:#ccc;height:1px;margin:.3em 0}.pure-menu-horizontal .pure-menu-separator{width:1px;height:1.3em;margin:0 .3em}.pure-menu-horizontal .pure-menu-children .pure-menu-separator{display:block;width:auto}.pure-menu-heading{text-transform:uppercase;color:#565d64}.pure-menu-link{color:#777}.pure-menu-children{background-color:#fff}.pure-menu-heading,.pure-menu-link{padding:.5em 1em}.pure-menu-disabled{opacity:.5}.pure-menu-disabled .pure-menu-link:hover{background-color:transparent;cursor:default}.pure-menu-active>.pure-menu-link,.pure-menu-link:focus,.pure-menu-link:hover{background-color:#eee}.pure-menu-selected>.pure-menu-link,.pure-menu-selected>.pure-menu-link:visited{color:#000}</style><style type=text/css media=screen>/*!Pure v3.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE*/.pure-g{display:flex;flex-flow:row wrap;align-content:flex-start}.pure-u{display:inline-block;vertical-align:top}.pure-u-1,.pure-u-1-1,.pure-u-1-12,.pure-u-1-2,.pure-u-1-24,.pure-u-1-3,.pure-u-1-4,.pure-u-1-5,.pure-u-1-6,.pure-u-1-8,.pure-u-10-24,.pure-u-11-12,.pure-u-11-24,.pure-u-12-24,.pure-u-13-24,.pure-u-14-24,.pure-u-15-24,.pure-u-16-24,.pure-u-17-24,.pure-u-18-24,.pure-u-19-24,.pure-u-2-24,.pure-u-2-3,.pure-u-2-5,.pure-u-20-24,.pure-u-21-24,.pure-u-22-24,.pure-u-23-24,.pure-u-24-24,.pure-u-3-24,.pure-u-3-4,.pure-u-3-5,.pure-u-3-8,.pure-u-4-24,.pure-u-4-5,.pure-u-5-12,.pure-u-5-24,.pure-u-5-5,.pure-u-5-6,.pure-u-5-8,.pure-u-6-24,.pure-u-7-12,.pure-u-7-24,.pure-u-7-8,.pure-u-8-24,.pure-u-9-24{display:inline-block;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-1-24{width:4.1667%}.pure-u-1-12,.pure-u-2-24{width:8.3333%}.pure-u-1-8,.pure-u-3-24{width:12.5%}.pure-u-1-6,.pure-u-4-24{width:16.6667%}.pure-u-1-5{width:20%}.pure-u-5-24{width:20.8333%}.pure-u-1-4,.pure-u-6-24{width:25%}.pure-u-7-24{width:29.1667%}.pure-u-1-3,.pure-u-8-24{width:33.3333%}.pure-u-3-8,.pure-u-9-24{width:37.5%}.pure-u-2-5{width:40%}.pure-u-10-24,.pure-u-5-12{width:41.6667%}.pure-u-11-24{width:45.8333%}.pure-u-1-2,.pure-u-12-24{width:50%}.pure-u-13-24{width:54.1667%}.pure-u-14-24,.pure-u-7-12{width:58.3333%}.pure-u-3-5{width:60%}.pure-u-15-24,.pure-u-5-8{width:62.5%}.pure-u-16-24,.pure-u-2-3{width:66.6667%}.pure-u-17-24{width:70.8333%}.pure-u-18-24,.pure-u-3-4{width:75%}.pure-u-19-24{width:79.1667%}.pure-u-4-5{width:80%}.pure-u-20-24,.pure-u-5-6{width:83.3333%}.pure-u-21-24,.pure-u-7-8{width:87.5%}.pure-u-11-12,.pure-u-22-24{width:91.6667%}.pure-u-23-24{width:95.8333%}.pure-u-1,.pure-u-1-1,.pure-u-24-24,.pure-u-5-5{width:100%}</style><style type=text/css media=screen>/*!Pure v3.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE*/.pure-table{border-collapse:collapse;border-spacing:0;empty-cells:show;border:1px solid #cbcbcb}.pure-table caption{color:#000;font:italic 85%/1 arial,sans-serif;padding:1em 0;text-align:center}.pure-table td,.pure-table th{border-left:1px solid #cbcbcb;border-width:0 0 0 1px;font-size:inherit;margin:0;overflow:visible;padding:.5em 1em}.pure-table thead{background-color:#e0e0e0;color:#000;text-align:left;vertical-align:bottom}.pure-table td{background-color:transparent}.pure-table-odd td{background-color:#f2f2f2}.pure-table-striped tr:nth-child(2n-1) td{background-color:#f2f2f2}.pure-table-bordered td{border-bottom:1px solid #cbcbcb}.pure-table-bordered tbody>tr:last-child>td{border-bottom-width:0}.pure-table-horizontal td,.pure-table-horizontal th{border-width:0 0 1px;border-bottom:1px solid #cbcbcb}.pure-table-horizontal tbody>tr:last-child>td{border-bottom-width:0}</style><style type=text/css media=screen>/*!Pure v1.0.0
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/yahoo/pure/blob/master/LICENSE.md*/@media screen and (min-width:35.5em){.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-1-12,.pure-u-sm-1-2,.pure-u-sm-1-24,.pure-u-sm-1-3,.pure-u-sm-1-4,.pure-u-sm-1-5,.pure-u-sm-1-6,.pure-u-sm-1-8,.pure-u-sm-10-24,.pure-u-sm-11-12,.pure-u-sm-11-24,.pure-u-sm-12-24,.pure-u-sm-13-24,.pure-u-sm-14-24,.pure-u-sm-15-24,.pure-u-sm-16-24,.pure-u-sm-17-24,.pure-u-sm-18-24,.pure-u-sm-19-24,.pure-u-sm-2-24,.pure-u-sm-2-3,.pure-u-sm-2-5,.pure-u-sm-20-24,.pure-u-sm-21-24,.pure-u-sm-22-24,.pure-u-sm-23-24,.pure-u-sm-24-24,.pure-u-sm-3-24,.pure-u-sm-3-4,.pure-u-sm-3-5,.pure-u-sm-3-8,.pure-u-sm-4-24,.pure-u-sm-4-5,.pure-u-sm-5-12,.pure-u-sm-5-24,.pure-u-sm-5-5,.pure-u-sm-5-6,.pure-u-sm-5-8,.pure-u-sm-6-24,.pure-u-sm-7-12,.pure-u-sm-7-24,.pure-u-sm-7-8,.pure-u-sm-8-24,.pure-u-sm-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-sm-1-24{width:4.1667%}.pure-u-sm-1-12,.pure-u-sm-2-24{width:8.3333%}.pure-u-sm-1-8,.pure-u-sm-3-24{width:12.5%}.pure-u-sm-1-6,.pure-u-sm-4-24{width:16.6667%}.pure-u-sm-1-5{width:20%}.pure-u-sm-5-24{width:20.8333%}.pure-u-sm-1-4,.pure-u-sm-6-24{width:25%}.pure-u-sm-7-24{width:29.1667%}.pure-u-sm-1-3,.pure-u-sm-8-24{width:33.3333%}.pure-u-sm-3-8,.pure-u-sm-9-24{width:37.5%}.pure-u-sm-2-5{width:40%}.pure-u-sm-10-24,.pure-u-sm-5-12{width:41.6667%}.pure-u-sm-11-24{width:45.8333%}.pure-u-sm-1-2,.pure-u-sm-12-24{width:50%}.pure-u-sm-13-24{width:54.1667%}.pure-u-sm-14-24,.pure-u-sm-7-12{width:58.3333%}.pure-u-sm-3-5{width:60%}.pure-u-sm-15-24,.pure-u-sm-5-8{width:62.5%}.pure-u-sm-16-24,.pure-u-sm-2-3{width:66.6667%}.pure-u-sm-17-24{width:70.8333%}.pure-u-sm-18-24,.pure-u-sm-3-4{width:75%}.pure-u-sm-19-24{width:79.1667%}.pure-u-sm-4-5{width:80%}.pure-u-sm-20-24,.pure-u-sm-5-6{width:83.3333%}.pure-u-sm-21-24,.pure-u-sm-7-8{width:87.5%}.pure-u-sm-11-12,.pure-u-sm-22-24{width:91.6667%}.pure-u-sm-23-24{width:95.8333%}.pure-u-sm-1,.pure-u-sm-1-1,.pure-u-sm-24-24,.pure-u-sm-5-5{width:100%}}@media screen and (min-width:48em){.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-1-12,.pure-u-md-1-2,.pure-u-md-1-24,.pure-u-md-1-3,.pure-u-md-1-4,.pure-u-md-1-5,.pure-u-md-1-6,.pure-u-md-1-8,.pure-u-md-10-24,.pure-u-md-11-12,.pure-u-md-11-24,.pure-u-md-12-24,.pure-u-md-13-24,.pure-u-md-14-24,.pure-u-md-15-24,.pure-u-md-16-24,.pure-u-md-17-24,.pure-u-md-18-24,.pure-u-md-19-24,.pure-u-md-2-24,.pure-u-md-2-3,.pure-u-md-2-5,.pure-u-md-20-24,.pure-u-md-21-24,.pure-u-md-22-24,.pure-u-md-23-24,.pure-u-md-24-24,.pure-u-md-3-24,.pure-u-md-3-4,.pure-u-md-3-5,.pure-u-md-3-8,.pure-u-md-4-24,.pure-u-md-4-5,.pure-u-md-5-12,.pure-u-md-5-24,.pure-u-md-5-5,.pure-u-md-5-6,.pure-u-md-5-8,.pure-u-md-6-24,.pure-u-md-7-12,.pure-u-md-7-24,.pure-u-md-7-8,.pure-u-md-8-24,.pure-u-md-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-md-1-24{width:4.1667%}.pure-u-md-1-12,.pure-u-md-2-24{width:8.3333%}.pure-u-md-1-8,.pure-u-md-3-24{width:12.5%}.pure-u-md-1-6,.pure-u-md-4-24{width:16.6667%}.pure-u-md-1-5{width:20%}.pure-u-md-5-24{width:20.8333%}.pure-u-md-1-4,.pure-u-md-6-24{width:25%}.pure-u-md-7-24{width:29.1667%}.pure-u-md-1-3,.pure-u-md-8-24{width:33.3333%}.pure-u-md-3-8,.pure-u-md-9-24{width:37.5%}.pure-u-md-2-5{width:40%}.pure-u-md-10-24,.pure-u-md-5-12{width:41.6667%}.pure-u-md-11-24{width:45.8333%}.pure-u-md-1-2,.pure-u-md-12-24{width:50%}.pure-u-md-13-24{width:54.1667%}.pure-u-md-14-24,.pure-u-md-7-12{width:58.3333%}.pure-u-md-3-5{width:60%}.pure-u-md-15-24,.pure-u-md-5-8{width:62.5%}.pure-u-md-16-24,.pure-u-md-2-3{width:66.6667%}.pure-u-md-17-24{width:70.8333%}.pure-u-md-18-24,.pure-u-md-3-4{width:75%}.pure-u-md-19-24{width:79.1667%}.pure-u-md-4-5{width:80%}.pure-u-md-20-24,.pure-u-md-5-6{width:83.3333%}.pure-u-md-21-24,.pure-u-md-7-8{width:87.5%}.pure-u-md-11-12,.pure-u-md-22-24{width:91.6667%}.pure-u-md-23-24{width:95.8333%}.pure-u-md-1,.pure-u-md-1-1,.pure-u-md-24-24,.pure-u-md-5-5{width:100%}}@media screen and (min-width:64em){.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-1-12,.pure-u-lg-1-2,.pure-u-lg-1-24,.pure-u-lg-1-3,.pure-u-lg-1-4,.pure-u-lg-1-5,.pure-u-lg-1-6,.pure-u-lg-1-8,.pure-u-lg-10-24,.pure-u-lg-11-12,.pure-u-lg-11-24,.pure-u-lg-12-24,.pure-u-lg-13-24,.pure-u-lg-14-24,.pure-u-lg-15-24,.pure-u-lg-16-24,.pure-u-lg-17-24,.pure-u-lg-18-24,.pure-u-lg-19-24,.pure-u-lg-2-24,.pure-u-lg-2-3,.pure-u-lg-2-5,.pure-u-lg-20-24,.pure-u-lg-21-24,.pure-u-lg-22-24,.pure-u-lg-23-24,.pure-u-lg-24-24,.pure-u-lg-3-24,.pure-u-lg-3-4,.pure-u-lg-3-5,.pure-u-lg-3-8,.pure-u-lg-4-24,.pure-u-lg-4-5,.pure-u-lg-5-12,.pure-u-lg-5-24,.pure-u-lg-5-5,.pure-u-lg-5-6,.pure-u-lg-5-8,.pure-u-lg-6-24,.pure-u-lg-7-12,.pure-u-lg-7-24,.pure-u-lg-7-8,.pure-u-lg-8-24,.pure-u-lg-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-lg-1-24{width:4.1667%}.pure-u-lg-1-12,.pure-u-lg-2-24{width:8.3333%}.pure-u-lg-1-8,.pure-u-lg-3-24{width:12.5%}.pure-u-lg-1-6,.pure-u-lg-4-24{width:16.6667%}.pure-u-lg-1-5{width:20%}.pure-u-lg-5-24{width:20.8333%}.pure-u-lg-1-4,.pure-u-lg-6-24{width:25%}.pure-u-lg-7-24{width:29.1667%}.pure-u-lg-1-3,.pure-u-lg-8-24{width:33.3333%}.pure-u-lg-3-8,.pure-u-lg-9-24{width:37.5%}.pure-u-lg-2-5{width:40%}.pure-u-lg-10-24,.pure-u-lg-5-12{width:41.6667%}.pure-u-lg-11-24{width:45.8333%}.pure-u-lg-1-2,.pure-u-lg-12-24{width:50%}.pure-u-lg-13-24{width:54.1667%}.pure-u-lg-14-24,.pure-u-lg-7-12{width:58.3333%}.pure-u-lg-3-5{width:60%}.pure-u-lg-15-24,.pure-u-lg-5-8{width:62.5%}.pure-u-lg-16-24,.pure-u-lg-2-3{width:66.6667%}.pure-u-lg-17-24{width:70.8333%}.pure-u-lg-18-24,.pure-u-lg-3-4{width:75%}.pure-u-lg-19-24{width:79.1667%}.pure-u-lg-4-5{width:80%}.pure-u-lg-20-24,.pure-u-lg-5-6{width:83.3333%}.pure-u-lg-21-24,.pure-u-lg-7-8{width:87.5%}.pure-u-lg-11-12,.pure-u-lg-22-24{width:91.6667%}.pure-u-lg-23-24{width:95.8333%}.pure-u-lg-1,.pure-u-lg-1-1,.pure-u-lg-24-24,.pure-u-lg-5-5{width:100%}}@media screen and (min-width:80em){.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-1-12,.pure-u-xl-1-2,.pure-u-xl-1-24,.pure-u-xl-1-3,.pure-u-xl-1-4,.pure-u-xl-1-5,.pure-u-xl-1-6,.pure-u-xl-1-8,.pure-u-xl-10-24,.pure-u-xl-11-12,.pure-u-xl-11-24,.pure-u-xl-12-24,.pure-u-xl-13-24,.pure-u-xl-14-24,.pure-u-xl-15-24,.pure-u-xl-16-24,.pure-u-xl-17-24,.pure-u-xl-18-24,.pure-u-xl-19-24,.pure-u-xl-2-24,.pure-u-xl-2-3,.pure-u-xl-2-5,.pure-u-xl-20-24,.pure-u-xl-21-24,.pure-u-xl-22-24,.pure-u-xl-23-24,.pure-u-xl-24-24,.pure-u-xl-3-24,.pure-u-xl-3-4,.pure-u-xl-3-5,.pure-u-xl-3-8,.pure-u-xl-4-24,.pure-u-xl-4-5,.pure-u-xl-5-12,.pure-u-xl-5-24,.pure-u-xl-5-5,.pure-u-xl-5-6,.pure-u-xl-5-8,.pure-u-xl-6-24,.pure-u-xl-7-12,.pure-u-xl-7-24,.pure-u-xl-7-8,.pure-u-xl-8-24,.pure-u-xl-9-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-xl-1-24{width:4.1667%}.pure-u-xl-1-12,.pure-u-xl-2-24{width:8.3333%}.pure-u-xl-1-8,.pure-u-xl-3-24{width:12.5%}.pure-u-xl-1-6,.pure-u-xl-4-24{width:16.6667%}.pure-u-xl-1-5{width:20%}.pure-u-xl-5-24{width:20.8333%}.pure-u-xl-1-4,.pure-u-xl-6-24{width:25%}.pure-u-xl-7-24{width:29.1667%}.pure-u-xl-1-3,.pure-u-xl-8-24{width:33.3333%}.pure-u-xl-3-8,.pure-u-xl-9-24{width:37.5%}.pure-u-xl-2-5{width:40%}.pure-u-xl-10-24,.pure-u-xl-5-12{width:41.6667%}.pure-u-xl-11-24{width:45.8333%}.pure-u-xl-1-2,.pure-u-xl-12-24{width:50%}.pure-u-xl-13-24{width:54.1667%}.pure-u-xl-14-24,.pure-u-xl-7-12{width:58.3333%}.pure-u-xl-3-5{width:60%}.pure-u-xl-15-24,.pure-u-xl-5-8{width:62.5%}.pure-u-xl-16-24,.pure-u-xl-2-3{width:66.6667%}.pure-u-xl-17-24{width:70.8333%}.pure-u-xl-18-24,.pure-u-xl-3-4{width:75%}.pure-u-xl-19-24{width:79.1667%}.pure-u-xl-4-5{width:80%}.pure-u-xl-20-24,.pure-u-xl-5-6{width:83.3333%}.pure-u-xl-21-24,.pure-u-xl-7-8{width:87.5%}.pure-u-xl-11-12,.pure-u-xl-22-24{width:91.6667%}.pure-u-xl-23-24{width:95.8333%}.pure-u-xl-1,.pure-u-xl-1-1,.pure-u-xl-24-24,.pure-u-xl-5-5{width:100%}}</style><style type=text/css media=screen>:root{--color:#484848;--color-footnote:#575757;--color-footer-content:#bbb;--background-color:rgb(252, 252, 252);--background-color-code:rgb(240, 240, 240);--background-color-toggle-content:rgb(249, 249, 249);--link-color:#c05b4d;--link-color-hover:#a5473a;--list-link-color:#336699;--border-navbar-and-footer:#e3e3e3}</style><style type=text/css media=screen>html{min-height:100%;width:100%;position:relative}body{background-color:#fcfcfc;background-color:var(--background-color);color:#484848;color:var(--color)}a{text-decoration:none}kbd,pre,code,samp{background-color:#f0f0f0;background-color:var(--background-color-code)}.nav-menu{margin-top:5px;padding-bottom:5px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#e3e3e3;border-bottom-color:var(--border-navbar-and-footer)}.pure-menu-heading{text-transform:none;font-size:large}.pure-menu-link:hover{background-color:unset}.header{text-align:left;color:#484848;color:var(--color);margin-bottom:.5em}.header ul li{height:auto}.header ul li a{font-weight:700;color:#484848;color:var(--color);font-family:source sans pro,helveticaneue,helvetica neue,Helvetica,Arial,sans-serif}.header{font-weight:700;color:#484848;color:var(--color);font-family:source sans pro,helveticaneue,helvetica neue,Helvetica,Arial,sans-serif}.site-title{color:#484848;color:var(--color);text-transform:none;font-weight:400;font-family:source sans pro,helveticaneue,helvetica neue,Helvetica,Arial,sans-serif}.pull-right{float:right}.posts-name{text-transform:capitalize;font-weight:700;padding-left:1em;margin-top:1em;font-family:source sans pro,helveticaneue,helvetica neue,Helvetica,Arial,sans-serif}.posts{font-family:verdana,arial,helvetica,sans-serif;list-style-type:none;padding-left:1em}.posts li p{margin-top:0}.posts li{margin-bottom:1em}.posts li>a{color:#369;color:var(--list-link-color);text-decoration:none}.post-list{font-size:large}.footnote{font-family:verdana,arial,helvetica,sans-serif;color:#575757;color:var(--color-footnote);font-size:.75em;margin-bottom:0}.footnote a{color:#575757;color:var(--color-footnote)}.footnote a:hover{text-decoration:underline;color:#369;color:var(--list-link-color)}.footer{position:absolute;z-index:2;height:auto;width:100%;bottom:0}.footer-content{border-top-width:1px;border-top-style:solid;border-top-color:#e3e3e3;border-top:1px solid var(--border-navbar-and-footer);font-size:80%;color:#bbb;color:var(--color-footer-content)}.footer-content a{color:#575757;color:var(--color-footnote)}.footer-content ul{height:auto;margin-top:0;margin-bottom:0;display:inline-block;padding-left:0}#TableOfContents>ul{list-style:none;margin:0;padding:0}#gototop-btn{display:inline-block}#foot-name{color:#484848;color:var(--color);text-transform:none}#foot-copyright{padding-left:1em;padding-bottom:.5em;margin:0}.post{font-family:proxima-nova,helvetica neue,Helvetica,Roboto,Arial,sans-serif;color:#484848;color:var(--color);letter-spacing:normal;padding-left:.5em}.post h1,h2,h3,h4,h5,h6{font-weight:700;letter-spacing:normal}.post-content{z-index:9;overflow:auto;padding:0;padding-bottom:3em;font-size:16px;line-height:1.4}.post-content img{max-width:100%;height:auto}.post-content pre{padding:.5em}.post a{color:#c05b4d;color:var(--link-color);text-decoration:none}.post a:hover{color:#a5473a;color:var(--link-color-hover);text-decoration:underline}.post h1{font-size:28px}.post h2{font-size:25px}.post h3{font-size:23px}.post h4{font-size:21px}.post h5{font-size:19px}.post h6{font-size:18px}.post-title{margin-top:0;margin-bottom:1em}.post-title h1{font-weight:700;font-size:39px;line-height:40px;margin-top:0;margin-bottom:0}@media screen and (max-width:768px){.desktop{display:none}.mobile{display:block}#toggle-btn{display:inline-block;float:right;padding:.5em 1em;text-decoration:none;color:#484848;color:var(--color);font-weight:700}#toggle-content li{clear:both;height:auto;background-color:#f9f9f9;background-color:var(--background-color-toggle-content)}#toggle-home{display:inline-block}}@media screen and (min-width:769px){.mobile{display:none}.desktop{display:block}}</style><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon></head><body><div class="header pure-g"><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div><div class="pure-u-11-12 pure-u-md-20-24 pure-u-lg-7-12"><div class="desktop pure-menu pure-menu-horizontal nav-menu"><a href=/ class="site-title pure-menu-heading">随记</a><ul class="pure-menu-list pull-right"><li class=pure-menu-item><a href=/categories/development/ class=pure-menu-link>Development</a></li><li class=pure-menu-item><a href=/categories/os/ class=pure-menu-link>OS</a></li><li class=pure-menu-item><a href=/categories/reading/ class=pure-menu-link>Reading</a></li><li class=pure-menu-item><a href=/about/ class=pure-menu-link>About</a></li></ul></div><div class="mobile pure-menu nav-menu"><a href=/ class="site-title pure-menu-heading" id=toggle-home>随记</a>
<a href=# id=toggle-btn>&#9776;</a><ul class=pure-menu-list id=toggle-content style=display:none><li class=pure-menu-item><a href=/categories/development/ class=pure-menu-link>Development</a></li><li class=pure-menu-item><a href=/categories/os/ class=pure-menu-link>OS</a></li><li class=pure-menu-item><a href=/categories/reading/ class=pure-menu-link>Reading</a></li><li class=pure-menu-item><a href=/about class=pure-menu-link>About</a></li></ul></div></div><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div></div><div class=pure-g><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div><div class="pure-u-11-12 pure-u-md-20-24 pure-u-lg-7-12"><div class=post><div class=post-title><p class=footnote><time datetime="2019-10-01 09:16:46 +0800 CST">2019-10-01
</time>|
tags: [ <a href=/tags/ipv6>IPv6</a> ]
categories: [ <a href=/categories/os>OS</a> ]</p><h1>IPv6 过渡机制</h1></div><div class=post-content><nav id=TableOfContents><ul><li><a href=#ipv6-过渡机制要解决什么问题>IPv6 过渡机制要解决什么问题？</a></li><li><a href=#ipv6-到-ipv4-通信机制>IPv6 到 IPv4 通信机制</a></li><li><a href=#ipv6-过渡机制>IPv6 过渡机制</a></li><li><a href=#实现>实现</a></li><li><a href=#参考>参考</a></li></ul></nav><h2 id=ipv6-过渡机制要解决什么问题>IPv6 过渡机制要解决什么问题？</h2><p>从最早的 IPv4-only 网络，到 IPv4/IPv6 双协议网络，到最终态的 IPv6-only 网络，这其中涉及到三方：</p><p><img src=network.svg alt=network></p><p>不考虑 WAN 里不同 ISP 之间互联，LAN 和 WAN 里的网络有如下可能：</p><ol><li>LAN<ol><li>IPv4 only</li><li>IPv4/IPv6 dual stack</li><li>IPv6 only</li></ol></li><li>WAN<ol><li>IPv4 only</li><li>IPv4/IPv6 dual stack</li><li>IPv6 only</li></ol></li></ol><p>不考虑同样协议栈的直连，那么 LAN ⟶ WAN ⟶ LAN 互联有如下可能：</p><ol><li>IPv6 ⟶ IPv4 ⟶ IPv6: IPv6 客户端通过 IPv4-only 网络连接 IPv6 服务端<ul><li>最早的 IPv6 互联方案，使用 IPv4 上的隧道技术比如 6in4, 6to4, 6rd，随着 IPv6 普及，ISP 转向 IPv6-only 网络，这种过渡方案会逐渐废弃</li></ul></li><li>IPv4 ⟶ IPv6 ⟶ IPv4: IPv4 客户端通过 IPv6-only 网络连接 IPv4 服务端<ul><li>由于 ISP 支持双协议栈成本很高，ISP 倾向于部署 IPv6 only 的网络，使用 <a href=https://tools.ietf.org/html/draft-ietf-v6ops-transition-ipv4aas-15>IPv4aaS</a> 定义的技术(464XLAT, DS-Lite, lw4o6, MAP-E, MAP-T) 提供 IPv4 互联服务，这是目前的主流过渡方案</li></ul></li><li>IPv6 ⟶ IPv4 or IPv6 ⟶ IPv4: IPv6 客户端连接 IPv4 服务端<ul><li>IPv6 ⟶ IPv4: 由于 ISP 双协议栈支持成本，以及 IPv4 地址耗尽，ISP 会倾向于不给终端设备分配 IPv4 地址，这种情况下跟第二种类似</li></ul></li><li>IPv4 ⟶ IPv4 or IPv6 ⟶ IPv6: IPv4 客户端连接 IPv6 服务端<ul><li>IPv4 ⟶ IPv6: NAT-PT 和 NAPT-PT <a href=https://tools.ietf.org/html/rfc4966>已经废弃</a>，这种过渡方案是不建议的，客户端应该升级到 IPv6 协议栈</li></ul></li></ol><p>综上，IPv6 过渡机制最根本的是要解决 IPv6 ⟶ IPv4 通信。</p><h2 id=ipv6-到-ipv4-通信机制>IPv6 到 IPv4 通信机制</h2><p>IPv6 ⟶ IPv4 有两个问题要解决：</p><ol><li>IPv6 packet 到 IPv4 packet 协议转换，包括 IPv6 ↔︎ IPv4 和 ICMPv6 ↔︎ ICMPv4 的转换，有这些解决办法：<ul><li>应用层网关，比如 HAProxy、Nginx 等，在双协议栈机器上转换。</li><li>网络层协议转换，这是 SIIT 和 NAT64 解决的。</li></ul></li><li>有些 IPv4 协议会在协议的载荷里嵌入 IPv4 地址或者域名，客户端通过 IPv6 协议拿到后，如果客户端是双协议接入，那么可以直接用 IPv4 协议通信，如果是客户端或者 ISP 是 IPv6 only 接入，那么需要一种机制把 IPv4 地址转成 IPv6 地址再通讯，这有几个办法：<ul><li>DNS64：比如 Bind 9 和 Unbound，它们可以把 A 记录加个前缀改写成 AAAA 记录，缺点是会破坏 DNSSEC ，客户端可以用 DNS over TLS，DNS over HTTPS 之类的办法解决，但总之并不完美，而且也不支持协议载荷里直接内嵌 IPv4 地址。</li><li><a href=https://tools.ietf.org/html/rfc7050>RFC7050</a> 定义的 ipv4only.arpa. 域名，用其返回的 AAAA 地址，把末尾 32bit 替换成目标 IPv4 地址。</li><li>464XLAT 中的 CLAT(Customer side transLATor) : Android 4.3, iOS 12.0, Windows 10, FreeBSD 11.3 & 12.1 支持 CLAT，可以将 IPv4 数据包转成 IPv6 数据包再发出去。这种方式显然比 DNS64 方案更好。</li></ul></li></ol><h2 id=ipv6-过渡机制>IPv6 过渡机制</h2><p>除了双协议栈，有两种 IPv4/IPv6 <a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism>互操作办法</a>：</p><ol><li>tunneling<ol><li>IPv6 over IPv4，参考 <a href=https://tools.ietf.org/html/rfc7059>RFC 7059: A Comparison of IPv6-over-IPv4 Tunnel Mechanisms</a><ol><li><a href=https://en.wikipedia.org/wiki/6in4>6in4</a>: 使用 IP 协议号 41，需要静态配置 tunnel；</li><li><a href=https://en.wikipedia.org/wiki/6to4>6to4</a>: tunnel 对端 IPv4 <strong>公网</strong>地址内嵌在 IPv6 地址中，因此无需配置静态隧道。目前基本没人用这个了，6rd 是推荐的方案；</li><li><a href=https://en.wikipedia.org/wiki/6over4>6over4</a>: 依赖 IPv4 multicast 自动建立隧道；</li><li><a href=https://en.wikipedia.org/wiki/ISATAP>isatap</a>: 类似 6over4，但是不依赖 IPv4 multicast；容易使用，但是不推荐在生产环境使用；</li><li><a href=https://en.wikipedia.org/wiki/IPv6_rapid_deployment>6rd</a>: 派生自 6to4，区别在于 ISP 为客户提供 relay，因此服务质量容易保证，也能快速部署(rd 意为 rapid deployment)，<strong>推荐方案</strong>；</li><li><a href=https://en.wikipedia.org/wiki/Teredo_tunneling>teredo</a>: 使用 UDP 封装，支持 NAT 穿透。目前基本没人用这个了。</li><li><a href=https://en.wikipedia.org/wiki/Anything_In_Anything>ayiya</a>：使用 UDP/TCP/SCTP 封装，支持 NAT 穿透；</li><li>6PE, 6PVE: MPLS 网络上的 IPv6 和 IPv6 VPN；</li><li>LISP</li><li>GRE(RFC2784)</li><li>L2TPv2</li></ol></li><li>IPv4 over IPv6<ol><li><a href=https://en.wikipedia.org/wiki/4in6>4in6</a>: 需要静态配置 tunnel，可以使用 <a href=https://en.wikipedia.org/wiki/Tunnel_Setup_Protocol>TSP</a> 协议自动配置</li><li><a href=https://en.wikipedia.org/wiki/Anything_In_Anything>ayiya</a></li><li><a href=https://en.wikipedia.org/wiki/Mapping_of_Address_and_Port>MAP-E</a></li><li><a href=https://en.wikipedia.org/wiki/4over6>Public 4over6</a>: 不推荐，新的部署应该使用 Lightweight 4over6</li><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism#Dual-Stack_Lite_(DS-Lite)>DS-Lite</a>，<strong>推荐方案</strong>，CPE给客户分配 IPv4 私网地址(192.0.0.0/29)，并用 IPv4-in-IPv6封装成 IPv6 数据包发给 ISP，ISP 的运营商级别 NAT 转换成 IPv4 数据包</li><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism#Dual-Stack_Lite_(DS-Lite)>Lightweight 4over6</a>: DS-Lite 的扩展，把 NAT 功能转到客户侧路由器</li></ol></li></ol></li><li>translation<ol><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism#Stateless_IP/ICMP_Translation>SIIT</a></li><li><a href=https://tools.ietf.org/html/rfc7755>SIIT-DC</a>: 数据中心内部使用的 SIIT</li><li><a href=https://en.wikipedia.org/wiki/NAT64>NAT64</a></li><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism#464XLAT>464XLAT</a>: 结合 RFC 6145 stateless NAT64(Customer side transLATor, CLAT) 和 RFC6146 stateful NAT64(Provider side transLATor, PLAT)，CLAT 可以运行在客户侧路由器，也可以运行在客户设备上，PLAT 则运行在 ISP 网络里。</li><li><a href=https://en.wikipedia.org/wiki/IVI_Translation>IVI</a></li><li><a href=https://en.wikipedia.org/wiki/DIVI_Translation>dIVI</a>: 扩展了 IVI</li><li><a href=https://en.wikipedia.org/wiki/Mapping_of_Address_and_Port>MAP-T</a>: 即 dIVI-PD，扩展了 IVI 的设计。与 464XLAT、DS-Lite 相比，很大的好处是不需要运营商运行 stateful NAT64</li><li><a href=https://en.wikipedia.org/wiki/IPv4_Residual_Deployment>4rd</a>: 实验性质，比 MAP-E 和 MAP-T 更好</li><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism#Transport_Relay_Translation>TRT</a>: 在传输层通过 client(IPv6) ⟶ relay(IPv6)、relay(IPv4) ⟶ server(IPv4) 两条网络连接来转发 TCP/UDP，配合 DNS64，将去往 ipv4-addr 流量路由到 relay server 的 ipv6-prefix:ipv4-addr 地址</li><li><a href=https://tools.ietf.org/html/rfc6535>BIH</a>: 让遗留的 IPv4-only 应用访问 IPv6-only 服务</li></ol></li></ol><p>推荐的 Dual stack client ⟶ IPv6-only network ⟶ IPv4 server 通信机制：464XLAT、DS-Lite、Lw4o6、MAP(MAP-E, MAP-T), 4rd，注意这些除了 464XLAT，其它几个都是需要 ISP 分配特殊的地址段给 Customer 侧才能应用在 IPv6-only network 的方案，而 464XLAT 依赖的 DNS64 和 NAT64 可以在应用级别绕过去（服务端总是使用域名 + 域名预先配置 NAT64 server 地址，客户端特殊处理 IPv4 地址）。</p><h2 id=实现>实现</h2><ol><li>isatap: Windows XP、Vista、7、8、10, Windows Server 2008、2012, Linux, KAME(*BSD), Cisco IOS</li><li>6rd, 6to4, 6in4, ds-lite:<ol><li><a href=https://openwrt.org/docs/guide-user/network/ipv6_ipv4_transitioning>https://openwrt.org/docs/guide-user/network/ipv6_ipv4_transitioning</a></li></ol></li><li>NAT64<ol><li><a href=https://www.jool.mx/>https://www.jool.mx/</a> 看起来最流行</li><li><a href=https://www.wrapsix.org/>https://www.wrapsix.org/</a> user space, faster than kernelspace Ecdysis, faster than userspace stateless Tayga</li><li><a href=https://ecdysis.viagenie.ca/index.html>https://ecdysis.viagenie.ca/index.html</a> 有 Linux 内核模块，并且被收入 OpenBSD 的 pf 中</li><li>FreeBSD 11.1 的 ipfw_nat64, ipfw_nptv6 (Linux iptables-extensions 中也有 SNPT 和 DNPT 用于转换 IPv6 地址前缀)</li><li><a href=http://www.litech.org/tayga/>http://www.litech.org/tayga/</a> 用户空间，知名，成熟稳定，但性能不够好</li><li><a href=https://github.com/fln/nat64>https://github.com/fln/nat64</a> 内核模块</li><li><a href=https://github.com/lynic/xlat>https://github.com/lynic/xlat</a> 北邮同学作品，Go 语言实现</li></ol></li><li>IVI: <a href=http://www.ivi2.org/>http://www.ivi2.org/</a> 只有 linux-2.6 源码</li><li>MAP-E + MAP-T: <a href=https://openwrt.org/docs/guide-user/network/map>https://openwrt.org/docs/guide-user/network/map</a></li><li>DNS64<ol><li>Bind 9</li><li>Unbound</li></ol></li></ol><h2 id=参考>参考</h2><ol><li><a href=https://en.wikipedia.org/wiki/IPv6_transition_mechanism>https://en.wikipedia.org/wiki/IPv6_transition_mechanism</a></li><li>Silvia Hagen, IPv6 Essentials: Integrating IPv6 into Your IPv4 Network, O&rsquo;Reilly Media (2014)</li><li><a href=https://tools.ietf.org/html/rfc2765>RFC2765: Stateless IP/ICMP Translation Algorithm (SIIT)</a></li><li><a href=https://tools.ietf.org/html/rfc7084>RFC7084: Basic Requirements for IPv6 Customer Edge Routers</a></li><li><a href=https://tools.ietf.org/html/rfc8504>RFC8504: IPv6 Node Requirements</a></li><li><a href=https://tools.ietf.org/html/rfc4213>RFC4213: Basic Transition Mechanisms for IPv6 Host and Routers</a></li><li><a href=https://tools.ietf.org/html/rfc6144>RFC6144: Framework for IPv4/IPv6 Translation</a></li><li><a href=https://tools.ietf.org/html/rfc6145>RFC6145: IP/ICMP Translation Algorithm</a></li><li><a href=https://tools.ietf.org/html/rfc6146>RFC6146: Stateful NAT64</a></li><li><a href=https://tools.ietf.org/html/rfc6147>RFC6147: DNS64</a></li><li><a href=https://tools.ietf.org/html/rfc6052>RFC6052: IPv6 Addressing of IPv4/IPv6 Translators</a>，定义了 64:ff9b::/96 前缀用于全球因特网</li><li><a href=https://tools.ietf.org/html/rfc8215>RFC8215: Local-Use IPv4/IPv6 Translation Prefix</a>，定义了 64:ff9b:1::/48 前缀用于局域网</li><li><a href=https://tools.ietf.org/html/rfc4864>RFC4864: Local Network Protection for IPv6</a></li><li><a href=https://www.ietf.org/rfc/rfc4966.txt>RFC4966: Reasons to Move the NAT-PT to Historic Status</a></li><li><a href=https://tools.ietf.org/html/rfc6889>RFC6889: Analysis of Stateful 64 Translation</a></li><li><a href=https://tools.ietf.org/html/rfc4038>RFC4038: Application Aspects of IPv6 Transition</a></li><li><a href=https://tools.ietf.org/html/draft-ietf-v6ops-transition-ipv4aas-15>https://tools.ietf.org/html/draft-ietf-v6ops-transition-ipv4aas-15</a></li><li><a href=https://www.iana.org/assignments/ipv6-address-space/ipv6-address-space.xhtml>https://www.iana.org/assignments/ipv6-address-space/ipv6-address-space.xhtml</a></li><li><a href=https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml>https://www.iana.org/assignments/iana-ipv6-special-registry/iana-ipv6-special-registry.xhtml</a></li></ol></div></div></div><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div></div><div class="footer pure-g"><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div><div class="pure-u-11-12 pure-u-md-20-24 pure-u-lg-7-12"><div class=footer-content><div class="pure-menu pure-menu-horizontal"><ul><li class=pure-menu-item id=foot-name>© Yubao Liu</li></ul><a href=# class="pure-menu-link pull-right" id=gototop-btn>↑↑</a></div></div></div><div class="pure-u-1-24 pure-u-md-2-24 pure-u-lg-5-24"></div></div><script type=text/javascript>go(),window.addEventListener("resize",go);function go(){var e=document.querySelector(".desktop");document.documentElement.clientWidth>768?e.style.display="":e.style.display="none"}</script><script type=text/javascript>var a=document.querySelector("#toggle-btn"),b=document.querySelector("#toggle-content");a.addEventListener("click",function(){""==b.style.display?(b.style.display="none",a.innerHTML="☰"):(b.style.display="",a.innerHTML="X")})</script></body></html>